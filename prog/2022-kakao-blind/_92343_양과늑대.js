/**
 * ìµœëŒ€í•œ ëª¨ì„ ìˆ˜ ìžˆëŠ” ì–‘ì€ ëª‡ ë§ˆë¦¬ì¸ì§€ êµ¬í•˜ìž.
 *
 * 2ì§„ íŠ¸ë¦¬ ì´ˆì›ì—ëŠ” ëŠ‘ëŒ€ì™€ ì–‘ì´ ì¡´ìž¬í•œë‹¤.
 * ë£¨íŠ¸ ë…¸ë“œì—ì„œ ì¶œë°œí•˜ì—¬ ê° ë…¸ë“œë¥¼ ëŒì•„ë‹¤ë…€ ì–‘ì„ ëª¨ìœ¼ë ¤ê³  í•œë‹¤.
 * ê° ë…¸ë“œë¥¼ ë°©ë¬¸í•  ë•Œë§ˆë‹¤ í•´ë‹¹ ë…¸ë“œì— ìžˆëŠ” ì–‘ê³¼ ëŠ‘ëŒ€ê°€ ë”°ë¼ì˜¨ë‹¤.
 * ì´ë•Œ, ì–‘ì˜ ìˆ˜ë³´ë‹¤ ëŠ‘ëŒ€ì˜ ìˆ˜ê°€ ê°™ê±°ë‚˜ ë§Žì•„ì§€ë©´ ëª¨ë“  ì–‘ì„ ìž¡ì•„ë¨¹ëŠ”ë‹¤.
 *
 * @param {*} info ê° ë…¸ë“œì— ìžˆëŠ” ì–‘/ëŠ‘ëŒ€ì— ëŒ€í•œ ì •ë³´ê°€ ë‹´ê¸´ ë°°ì—´ (2~17) / ì–‘:0, ëŠ‘ëŒ€:1 / ë£¨íŠ¸ ë…¸ë“œëŠ” í•­ìƒ 0
 * @param {*} edges 2ì§„ íŠ¸ë¦¬ì˜ ê° ë…¸ë“œë“¤ì˜ ì—°ê²° ê´€ê³„ë¥¼ ë‹´ì€ 2ì°¨ì› ë°°ì—´
 * @returns ëª¨ì„ ìˆ˜ ìžˆëŠ” ì–‘ì´ ìµœëŒ€ ëª‡ ë§ˆë¦¬ì¸ì§€
 *
 * ### ë¦¬ë·°
 * - í’€ì´ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
 *   2ì§„ íŠ¸ë¦¬ì—ì„œ ìƒì„±í•  ìˆ˜ ìžˆëŠ” ëª¨ë“  ê²½ë¡œì— ëŒ€í•´ì„œ ì™„ì „ íƒìƒ‰ì„ ì§„í–‰í•œë‹¤.
 *   ì´ë•Œ, ëŠ‘ëŒ€ì˜ ìˆ˜ê°€ ì–‘ì˜ ìˆ˜ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ì€ ê²½ìš°ëŠ” ì§„ìž…ì´ ë¶ˆê°€ëŠ¥í•˜ë¯€ë¡œ
 *   ì¡°ê±´ì— ë§žì§€ ì•ŠëŠ” ê²½ë¡œëŠ” ì œì™¸í•œë‹¤.
 *   ë˜í•œ, ìƒˆë¡œìš´ ê²½ë¡œë¥¼ ìƒì„±í•  ë•Œë§ˆë‹¤ ì–‘ì˜ ìµœëŒ“ê°’ì„ ë¹„êµí•˜ì—¬ ê°±ì‹ í•œë‹¤.
 *
 *   ë¬´í•œ ë£¨í”„ë¥¼ ë¹ ì§€ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´, ìƒì„±í•œ ê²½ë¡œë¥¼ ë³„ë„ë¡œ ì €ìž¥í•´ì„œ
 *   ì¤‘ë³µ ê²½ë¡œëŠ” ì œì™¸ì‹œì¼œì¤€ë‹¤.
 *
 * - ì²˜ìŒ ì ‘ê·¼ë²•ì€, (74% ì •ë‹µ)
 *   ë¨¼ì € ê°ê°ì˜ ì–‘ë“¤ì„ ë§Œë‚˜ê¸° ìœ„í•´,
 *   ìµœì†Œ ë§Œë‚˜ì•¼í•˜ëŠ” ëŠ‘ëŒ€ë“¤ì— ëŒ€í•œ ì •ë³´ë“¤(node)ì„ ë‹´ì€ ë°°ì—´ì„ ìƒì„±í•œë‹¤. (BFSë¡œ ì§„í–‰)
 *   ê·¸ë¦¬ê³  ìœ„ì˜ ë°°ì—´ë“¤ì„ í•˜ë‚˜ì˜ ë°°ì—´ì— ì €ìž¥í•˜ê³  ìˆœíšŒí•œë‹¤.
 *   ìˆœíšŒí•˜ë©´ì„œ, í˜„ìž¬ ì–‘ì˜ ë§ˆë¦¿ìˆ˜ì™€ ëŠ‘ëŒ€ì˜ ë§ˆë¦¿ìˆ˜ë¡œ ë§Œë‚  ìˆ˜ ìžˆëŠ” ì–‘ì„ ì°¾ì•„ë‚¸ë‹¤.
 *   ë” ì´ìƒ ë°ë ¤ì˜¬ ìˆ˜ ìžˆëŠ” ì–‘ì´ ì¡´ìž¬í•˜ì§€ ì•Šì„ ë•Œê¹Œì§€ ìˆœíšŒë¥¼ ë°˜ë³µí•œë‹¤.
 *
 *   ëŠ‘ëŒ€ì˜ ë§ˆë¦¿ìˆ˜ëŠ” ìˆœíšŒí•˜ë©´ì„œ ë§Œë‚œ ëŠ‘ëŒ€ë“¤ê³¼,
 *   í•´ë‹¹ ì–‘ì„ ë§Œë‚˜ê¸° ìœ„í•´ ìµœì†Œ ë§Œë‚˜ì•¼ í•˜ëŠ” ëŠ‘ëŒ€ë“¤ì„ Set ê°ì²´ì— ì „ë‹¬í•˜ë©´ êµ¬í•  ìˆ˜ ìžˆë‹¤.
 *
 *   ìœ„ì˜ ì ‘ê·¼ë²•ì´ ìž˜ëª»ëœ ì´ìœ ëŠ”,
 *   Aë²ˆ ì–‘ê³¼ Bë²ˆ ì–‘ ë‘˜ ì¤‘ì— í•œ ë§ˆë¦¬ë§Œ ë°ë ¤ì˜¬ ìˆ˜ ìžˆëŠ” ê²½ìš°,
 *   Aë²ˆ ì–‘ë³´ë‹¤ Bë²ˆ ì–‘ì„ ë°ë ¤ì™€ì•¼ ë” ë§Žì€ ì–‘ì„ ë°ë ¤ì˜¬ ìˆ˜ ìžˆëŠ” ê²½ìš°ê°€ ìžˆê¸° ë•Œë¬¸ì´ë‹¤.
 *   ì´ì— ëŒ€í•œ ë°˜ë¡€ëŠ” ì•„ëž˜ TEST CASEì—ì„œ 3ë²ˆì— í…Œì¼€ê°€ ì´ì— ì†í•œë‹¤.
 *
 * - ì—¬ëŸ¬ê°€ì§€ ì‹œë„ë¥¼ í•˜ë‹¤ê°€ ê²°êµ­ì—” ë‹µì•ˆì„ ì°¸ê³ í•œ ë¬¸ì œì´ë‹¤.. ðŸ˜­
 *   ì™„ì „ íƒìƒ‰ì„ í•´ì•¼ê² ë‹¤, ìƒê°ì€ í–ˆì§€ë§Œ ì–´ë–¤ ì‹ìœ¼ë¡œ ëª¨ë“  ê²½ë¡œë¥¼ ì°¾ì•„ì•¼ í•˜ëŠ”ì§€ ëª¨ë¥´ê² ë”ë¼.. ðŸ˜¥
 *
 * - ëŒ€ë¶€ë¶„ ì™„ì „íƒìƒ‰ + DFS + ë¹„íŠ¸ë§ˆìŠ¤í‚¹ ì¡°í•©ì¸ í’€ì´ê°€ ë§Žì•˜ë‹¤.
 *
 */

let answer = 1;
function solution(info, edges) {
    const graph = createGraph(edges, info);

    answer = 1;
    DFS(graph, 1, (paths = new Set()));
    return answer;
}

function createGraph(edges, info) {
    const graph = Array.from(Array(info.length), () => []);
    edges.forEach(([parent, child]) => graph[parent].push(child));
    graph.info = info;
    return graph;
}

const [SHEEP, WOLF] = [0, 1];
function DFS(graph, visitedNodes, paths) {
    if (isChekedPaths(paths, visitedNodes)) return;
    paths.add(visitedNodes);

    let [wolf, sheep] = countNodesTypes(graph, visitedNodes);
    if (wolf >= sheep) return;

    answer = Math.max(answer, sheep);

    graph.forEach((_, parent) => {
        if (isUnvisitedNode(visitedNodes, parent)) return;

        graph[parent].forEach((child) => {
            DFS(graph, visitedNodes | (1 << child), paths);
        });
    });
}

const isChekedPaths = (paths, visitedNodes) => paths.has(visitedNodes);

function countNodesTypes(graph, visitedNodes) {
    let [wolf, sheep] = [0, 0];
    graph.forEach((_, node) => {
        if (isUnvisitedNode(visitedNodes, node)) return;
        if (graph.info[node] === WOLF) wolf++;
        if (graph.info[node] === SHEEP) sheep++;
    });
    return [wolf, sheep];
}

const isUnvisitedNode = (visitedNodes, node) => !(visitedNodes & (1 << node));

/****** TEST CASE *******/
console.log(
    solution(
        [0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1],
        [
            [0, 1],
            [1, 2],
            [1, 4],
            [0, 8],
            [8, 7],
            [9, 10],
            [9, 11],
            [4, 3],
            [6, 5],
            [4, 6],
            [8, 9],
        ],
    ),
);

console.log(
    solution(
        [0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0],
        [
            [0, 1],
            [0, 2],
            [1, 3],
            [1, 4],
            [2, 5],
            [2, 6],
            [3, 7],
            [4, 8],
            [6, 9],
            [9, 10],
        ],
    ),
);

console.log(
    solution(
        [0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0],
        [
            [0, 1],
            [0, 2],
            [1, 3],
            [1, 4],
            [3, 7],
            [4, 8],
            [2, 5],
            [2, 6],
            [5, 9],
            [9, 11],
            [6, 10],
            [10, 12],
            [12, 13],
        ],
    ),
); // ë°˜ë¡€: 8

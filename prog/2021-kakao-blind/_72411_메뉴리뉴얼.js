/**
 * ì´ì „ì˜ ê° ì†ë‹˜ë“¤ì´ ì£¼ë¬¸í•  ë•Œ ê°€ìž¥ ë§Žì´ í•¨ê»˜ ì£¼ë¬¸í•œ ë‹¨í’ˆë©”ë‰´ë“¤ì„
 * ì½”ìŠ¤ìš”ë¦¬ ë©”ë‰´ë¡œ êµ¬ì„±í•˜ê³ ìž í•œë‹¤.
 * ë‹¨, ì½”ìŠ¤ìš”ë¦¬ ë©”ë‰´ëŠ” ìµœì†Œ 2ê°€ì§€ ì´ìƒì˜ ë‹¨í’ˆ ë©”ë‰´ë¡œ êµ¬ì„±í•œë‹¤.
 * ë˜í•œ, ìµœì†Œ 2ëª… ì´ìƒì˜ ì†ë‹˜ìœ¼ë¡œë¶€í„° ì£¼ë¬¸ëœ ë‹¨í’ˆë©”ë‰´ ì¡°í•©ì— ëŒ€í•´ì„œë§Œ í›„ë³´ì— í¬í•¨í•œë‹¤.
 *
 * @param {*} orders ê° ì†ë‹˜ë“¤ì´ ì£¼ë¬¸í•œ ë‹¨í’ˆë©”ë‰´ë“¤ì´ ë¬¸ìžì—´ í˜•ì‹ìœ¼ë¡œ ë‹´ê¸´ ë°°ì—´
 *                   (2~20)
 * @param {*} course ì¶”ê°€í•˜ê³  ì‹¶ì–´í•˜ëŠ” ì½”ìŠ¤ìš”ë¦¬ë¥¼ êµ¬ì„±í•˜ëŠ” ë‹¨í’ˆë©”ë‰´ë“¤ì˜ ê°¯ìˆ˜ê°€ ë‹´ê¸´ ë°°ì—´
 *                   (1~10)
 * @returns ìƒˆë¡œ ì¶”ê°€í•˜ê²Œ ë  ì½”ìŠ¤ìš”ë¦¬ì˜ ë©”ë‰´ êµ¬ì„± => ì˜¤ë¦„ì°¨ìˆœ
 *
 * ### ë¦¬ë·°
 * - í’€ì´ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
 *   ë¨¼ì €, ordersë¥¼ ëŒ€ìƒìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìžˆëŠ” ëª¨ë“  ë©”ë‰´ë¥¼ ìƒì„±í•œë‹¤. (ì¡°í•©)
 *   ì´ë•Œ, í•´ë‹¹ ë©”ë‰´ë¥¼ ì£¼ë¬¸í•œ íšŸìˆ˜ì™€ í•¨ê»˜ ì €ìž¥í•œë‹¤. {ë©”ë‰´: íšŸìˆ˜}
 *
 *   ê·¸ ë‹¤ìŒ, ë©”ë‰´ê°€ ë“±ìž¥í•˜ëŠ” íšŸìˆ˜ê°€ 2ì´ìƒì¸ ê²½ìš°ì™€ courseì˜ ì¡°ê±´ì— ì†í•˜ëŠ” ë©”ë‰´ë§Œ ê±¸ëŸ¬ë‚¸ë‹¤.
 *   ë˜í•œ, courseë³„ë¡œ ê°€ìž¥ ì£¼ë¬¸ íšŸìˆ˜ê°€ í° ë©”ë‰´ë§Œ ê±¸ëŸ¬ë‚¸ë‹¤.
 *
 *   ë§ˆì§€ë§‰ìœ¼ë¡œ, ë©”ë‰´ë¥¼ ì‚¬ì „ ìˆœìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœí•˜ì—¬ ë°˜í™˜í•œë‹¤.
 *
 * - ì²˜ìŒì—ëŠ”,
 *   "ê°€ìž¥ ë§Žì´ í•¨ê»˜ ì£¼ë¬¸ëœ ë‹¨í’ˆë©”ë‰´ ì¡°í•©" ì´ë¼ëŠ” ì¡°ê±´ì´,
 *   "ë‹¨í’ˆ ë©”ë‰´ë“¤ì˜ ê°œìˆ˜ê°€ ë™ì¼í•  ê²½ìš°, ê°€ìž¥ ë§Žì´ ì£¼ë¬¸í•œ ë©”ë‰´ë¥¼ ì„ íƒí•œë‹¤."
 *   ë¼ëŠ” ì¡°ê±´ì„ í¬í•¨í•˜ëŠ”ì§€ ëª°ëžë‹¤.
 *
 *   ê·¸ëž˜ì„œ ì£¼ë¬¸ íšŸìˆ˜ê°€ 2íšŒ ì´ìƒì¸ ê²½ìš°ë§Œ ê±¸ëŸ¬ëƒˆìœ¼ë©°,
 *   "í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ 1ë²ˆì—ì„œ "AC(4íšŒ)"ë³´ë‹¤ ì ê²Œ ì£¼ë¬¸í•œ "BCFG(2íšŒ)"ë„ ì •ë‹µì— í¬í•¨í•˜ëŠ”ë°,
 *   ì™œ "CD(3íšŒ)"ëŠ” í¬í•¨í•˜ì§€ ì•ŠëŠ”ê±¸ê¹Œ?" ë¼ëŠ” ì˜ë¬¸ì„ ê³„ì† ê³ ë¯¼í–ˆì—ˆë‹¤.
 *
 *   ì„¤ëª…ì´ ì¡°ê¸ˆ ë¶€ì‹¤í•˜ì§€ ì•Šì•˜ë‚˜ ìƒê°ì´ ë“ ë‹¤. ðŸ˜‚
 */

function solution(orders, course) {
    const menus = createMenus(orders);

    const maxOrders = maxOrdersPerCourse(menus);

    return menus
        .filter(
            ([menu, orderCount]) =>
                orderCount >= 2 &&
                course.includes(menu.length) &&
                maxOrders[menu.length] === orderCount,
        )
        .map(([menu]) => menu)
        .sort();
}

function createMenus(orders) {
    const menus = new Map();
    orders
        .map((order) => [...order].sort())
        .forEach((order) => combination('', 0, order));
    return Array.from(menus.entries());

    function combination(menu, index, order) {
        menus.set(menu, (menus.get(menu) || 0) + 1);

        for (let i = index; i < order.length; i++) {
            combination(menu + order[i], i + 1, order);
        }
    }
}

function maxOrdersPerCourse(menus) {
    return menus.reduce((maxOrders, [menu, orderCount]) => {
        maxOrders[menu.length] = Math.max(maxOrders[menu.length], orderCount);
        return maxOrders;
    }, Array(11).fill(0));
}

console.log(
    solution(['ABCFG', 'AC', 'CDE', 'ACDE', 'BCFG', 'ACDEH'], [2, 3, 4]),
);

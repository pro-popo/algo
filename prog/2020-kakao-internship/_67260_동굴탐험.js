/**
 * nê°œì˜ ë°©ìœ¼ë¡œ ì´ë£¨ì–´ì§„ ì§€í•˜ ë™êµ´ì„ íƒí—˜í•˜ê³ ìž í•œë‹¤.
 * ëª¨ë“  ë°©ì—ëŠ” 0 ~ n-1ê¹Œì§€ ë²ˆí˜¸ê°€ ë¶™ì–´ ìžˆê³ ,
 * ìž…êµ¬ëŠ” 0ë²ˆ ë°©ê³¼ ì—°ê²°ë˜ì–´ ìžˆë‹¤.
 *
 * ê° ë°©ë“¤ì€ ì–‘ë°©í–¥ í†µí–‰ì´ ê°€ëŠ¥í•˜ë©°,
 * ì„œë¡œ ë‹¤ë¥¸ ë‘ ë°©ì„ ì§ì ‘ ì—°ê²°í•˜ëŠ” í†µë¡œëŠ” ì˜¤ì§ í•˜ë‚˜ë‹¤.
 * ìž„ì˜ì˜ ì„œë¡œ ë‹¤ë¥¸ ë‘ ë°© ì‚¬ì´ì˜ ìµœë‹¨ê²½ë¡œëŠ” ë”± í•œ ê°€ì§€ë§Œ ì¡´ìž¬í•œë‹¤.
 * ë˜í•œ, ìž„ì˜ì˜ ë‘ ë°© ì‚¬ì´ì˜ ì´ë™ì´ ë¶ˆê°€ëŠ¥í•œ ê²½ìš°ëŠ” ì—†ë‹¤.
 *
 * íƒí—˜ ê³„íšì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
 * 1. ëª¨ë“  ë°©ì„ ì ì–´ë„ í•œ ë²ˆì€ ë°©ë¬¸í•´ì•¼ í•œë‹¤.
 * 2. íŠ¹ì • ë°©ì€ ë°©ë¬¸í•˜ê¸° ì „ì— ë°˜ë“œì‹œ ë¨¼ì € ë°©ë¬¸í•  ë°©ì´ ì •í•´ì ¸ ìžˆë‹¤.
 *    - ì˜ˆë¡œ, Aë²ˆ ë°©ì„ ë°©ë¬¸í•˜ê¸° ì „ì— Bë²ˆ ë°©ì„ ë¨¼ì € ë°©ë¬¸í•´ì•¼ í•œë‹¤.
 *    - ë¨¼ì € ë°©ë¬¸í•´ì•¼ í•˜ëŠ” ë°©ì€ ì—†ê±°ë‚˜, 1ê°œì´ë‹¤.
 *    - ë¨¼ì € ë°©ë¬¸í•´ì•¼ í•˜ëŠ” ë°©ì´ ë™ì¼í•œ ê²½ìš°ëŠ” ì—†ë‹¤.
 *    - ë¨¼ì € ë°©ë¬¸í•´ì•¼ í•˜ëŠ” ë°©ì´ë©´ì„œ, ë™ì‹œì— ë‚˜ì¤‘ì— ë°©ë¬¸í•´ì•¼ í•˜ëŠ” ë°©ì¸ ê²½ìš°ëŠ” ì—†ë‹¤.
 *    - ë¨¼ì € ë°©ë¬¸í•´ì•¼ í•˜ëŠ” ë°©ê³¼ ë‚˜ì¤‘ì— ë°©ë¬¸í•  ë°©ì„ ë°˜ë“œì‹œ ì—°ì†ì ìœ¼ë¡œ ë°©ë¬¸í•  í•„ìš”ëŠ” ì—†ë‹¤.
 *
 * ë˜í•œ,
 * - "A->B", "A->C"ì¸ ê²½ìš°ëŠ” ì—†ë‹¤
 * - "X->A", "Z->A"ì¸ ê²½ìš°ëŠ” ì—†ë‹¤.
 * - "A->B->C"ì¸ ê²½ìš°ëŠ” ì—†ë‹¤.
 *
 * @param {*} n ë°© ê°œìˆ˜ (2~200_000)
 * @param {*} path ë™êµ´ì˜ í†µë¡œì— ëŒ€í•œ 2ì°¨ì› ë°°ì—´ (n-1)
 *                 [ë°© ë²ˆí˜¸ A, ë°© ë²ˆí˜¸ B]
 * @param {*} order ë°©ë¬¸ ìˆœì„œê°€ ë‹´ê¸´ 2ì°¨ì› ë°°ì—´ (n/2)
 *                  [ë¨¼ì € ë°©ë¬¸í•  ë°© ë²ˆí˜¸ A, ë‚˜ì¤‘ì— ë°©ë¬¸í•  ë°© ë²ˆí˜¸ B]
 * @returns ê·œì¹™ì— ë§žê²Œ ëª¨ë“  ë°©ì„ íƒí—˜í•  ìˆ˜ ìžˆëŠ”ì§€ ë°˜í™˜
 *
 * ### ë¦¬ë·°
 * - í’€ì´ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
 *   ë¨¼ì € pathë¥¼ ìˆœíšŒí•˜ì—¬ ê·¸ëž˜í”„ë¥¼ í˜•ì„±í•œë‹¤.
 *   ê·¸ë¦¬ê³ , orderë¥¼ ìˆœíšŒí•˜ì—¬ ê° ë°©ì— ëŒ€í•´ ë¨¼ì € ë°©ë¬¸í•´ì•¼ í•˜ëŠ” ë°©ì„ ì €ìž¥í•œë‹¤. (highPrioirty)
 *
 *   ëª¨ë“  ë°©ì„ ë°©ë¬¸í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
 *   BFSë¥¼ í™œìš©í•˜ì—¬ 0ë²ˆ ë°©ë¶€í„° ìˆœíšŒí•œë‹¤.
 *   ì´ë•Œ, í˜„ìž¬ ë°©ë³´ë‹¤ ë¨¼ì € ë°©ë¬¸í•´ì•¼ í•˜ëŠ” ë°©ì´ ì¡´ìž¬í•˜ëŠ”ë° ì•„ì§ ë¯¸ë°©ë¬¸ ìƒíƒœë¼ë©´, í˜„ìž¬ ë°©ì€ ë‚˜ì¤‘ì— ë°©ë¬¸í•œë‹¤.
 *   ê·¸ë¦¬ê³  ë‚˜ì¤‘ì— ë¨¼ì € ë°©ë¬¸í•´ì•¼ í•˜ëŠ” ë°©ì˜ ë°©ë¬¸ì´ ëë‚¬ì„ ë•Œ,
 *   ë°©ë¬¸ì„ ë¯¸ë¤˜ë˜ ë°©ì„ ë°©ë¬¸í•  ìˆ˜ ìžˆë„ë¡ ë³„ë„ì˜ ë°°ì—´ì— ì €ìž¥í•œë‹¤. (lowPriority)
 *
 *   ê·¸ ë‹¤ìŒ, í˜„ìž¬ ë°©ì„ ë¨¼ì € ë°©ë¬¸í•˜ê¸° ìœ„í•´ ë°©ë¬¸ì„ ë¯¸ë¤˜ë˜ ë°©ì´ ìžˆì—ˆë‹¤ë©´, íì— ì¶”ê°€í•œë‹¤.
 *   ë˜í•œ í˜„ìž¬ ë°©ê³¼ ì´ì–´ì§„ ë°©ì´ ìžˆë‹¤ë©´, íì— ì¶”ê°€í•œë‹¤.
 *
 *   ìœ„ì˜ ê³¼ì •ì„ íê°€ ë¹Œ ë•Œê¹Œì§€ ë°˜ë³µí•œë‹¤.
 *   íƒìƒ‰ì´ ëë‚œ ë’¤, ëª¨ë“  ë°©ì„ ë°©ë¬¸í–ˆëŠ”ì§€ í™•ì¸í•œë‹¤.
 *
 * - ì²˜ìŒì—ëŠ”, pathë¥¼ tree í˜•íƒœë¡œ ë°”ê¾¼ ë‹¤ìŒì—,
 *   DFSë¡œ ê°€ìž¥ ë¨¼ì € ë°©ë¬¸í•´ì•¼ í•˜ëŠ” ë°©ì„ ë°©ë¬¸í•˜ì—¬ ëª¨ë“  ë°©ì„ íƒìƒ‰í•˜ê³ ìž í–ˆë‹¤.
 *   ì´ë•Œ, í˜„ìž¬ ë°©ì„ ë°©ë¬¸í•˜ë ¤ê³  í–ˆì„ ë•Œ ë¨¼ì € ì•žì—ì„œ ë°©ë¬¸í–ˆì„ ê²½ìš°,
 *   ì‚¬ì´í´ì´ í˜•ì„±ë˜ë¯€ë¡œ ëª¨ë“  ë°©ì„ ë°©ë¬¸í•  ìˆ˜ ì—†ë‹¤ê³  íŒë‹¨í–ˆë‹¤.
 *   ê·¸ëŸ¬ë‚˜, ìƒê°í•œ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„ì´ ìž˜ ì•ˆ ë¼ì„œ ê²°êµ­ ê¼¬ì—¬ë²„ë ¸ê³ ,
 *   ì™„ë²½í•˜ê²Œ ì´í•´ë¥¼ ëª» í•œ ìƒíƒœë¼ê³  íŒë‹¨í•˜ì—¬ ì¤‘ë„ í¬ê¸°í•´ ë²„ë ¸ë‹¤..ðŸ˜‚
 *
 * - ê²°êµ­ ë‹¤ë¥¸ í’€ì´ë¥¼ ì°¸ê³ í•˜ì—¬ í‘¼ ë¬¸ì œì´ë‹¤. ðŸ˜…
 *   DFS ëŒ€ì‹  BFSë¡œ ì ‘ê·¼í•´ë³´ë‹ˆ, ìƒê°ë³´ë‹¤ ë¬¸ì œë¥¼ ë³µìž¡í•˜ê²Œ ìƒê°í–ˆêµ¬ë‚˜...
 *   ì´ë§ˆë¥¼ íƒ ì³¤ë˜ ë¬¸ì œì˜€ë‹¤.. ðŸ¤¦â€â™€ï¸
 */

function solution(n, path, order) {
    const graph = createGraph(n, path);
    const highPrioirty = Array(n).fill(null);
    order.forEach(
        ([prioirtyNode, node]) => (highPrioirty[node] = prioirtyNode),
    );

    const queue = [0];
    const visited = new Set();
    const lowPriority = Array(n).fill(null);

    while (queue.length) {
        const node = queue.shift();

        if (highPrioirty[node] && !visited.has(highPrioirty[node])) {
            lowPriority[highPrioirty[node]] = node;
            continue;
        }
        if (lowPriority[node]) queue.push(lowPriority[node]);

        for (const child of graph[node]) {
            if (visited.has(child)) continue;
            queue.push(child);
        }

        visited.add(node);
    }

    return isAllVisited();

    function isAllVisited() {
        return visited.size === n;
    }
}

function createGraph(n, edges) {
    const graph = Array.from(Array(n), () => []);
    edges.forEach(([node, other]) => {
        graph[node].push(other);
        graph[other].push(node);
    });
    return graph;
}

/****** TEST CASE *******/

console.log(
    solution(
        9,
        [
            [0, 1],
            [0, 3],
            [0, 7],
            [8, 1],
            [3, 6],
            [1, 2],
            [4, 7],
            [7, 5],
        ],
        [
            [8, 5],
            [6, 7],
            [4, 1],
        ],
    ),
);

console.log(
    solution(
        9,
        [
            [8, 1],
            [0, 1],
            [1, 2],
            [0, 7],
            [4, 7],
            [0, 3],
            [7, 5],
            [3, 6],
        ],
        [
            [4, 1],
            [5, 2],
        ],
    ),
);

console.log(
    solution(
        9,
        [
            [0, 1],
            [0, 3],
            [0, 7],
            [8, 1],
            [3, 6],
            [1, 2],
            [4, 7],
            [7, 5],
        ],
        [
            [4, 1],
            [8, 7],
            [6, 5],
        ],
    ),
);
